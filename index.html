<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Automatic MP3 Player</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji"; line-height: 1.6; background-color: #f0f2f5; padding: 20px; color: #1c1e21; }
        #player-container { max-width: 600px; margin: auto; background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        h1, h2 { text-align: center; color: #1877f2; }
        audio { width: 100%; margin-top: 20px; border-radius: 999px; }
        #playlist { list-style: none; padding: 0; max-height: 300px; overflow-y: auto; border-top: 1px solid #ddd; }
        #playlist li { display: flex; align-items: center; padding: 12px 15px; border-bottom: 1px solid #ddd; cursor: pointer; transition: background-color 0.2s ease; }
        #playlist li:before { content: 'â–¶'; margin-right: 15px; color: #aaa; font-size: 0.8em; }
        #playlist li:hover { background-color: #f0f2f5; }
        #playlist li.active { background-color: #e7f3ff; font-weight: bold; color: #1877f2; }
        #playlist li.active:before { content: 'ðŸŽµ'; color: #1877f2; }
        #now-playing { font-weight: bold; text-align: center; margin-bottom: 15px; color: #606770; }
        #loading { text-align: center; padding: 20px; color: #606770; }
    </style>
</head>
<body>

<div id="player-container">
    <h1>Auto-Playlist Player ðŸ’¿</h1>
    <div id="now-playing">Fetching songs from GitHub...</div>
    <audio id="audio-player" controls></audio>
    <h2>Playlist</h2>
    <ul id="playlist">
        <div id="loading">Loading...</div>
    </ul>
</div>

<script>
    // --- CONFIGURATION ---
    // 1. Change to your GitHub username
    const GITHUB_USER = "himalayasingh";
    // 2. Change to your repository name
    const GITHUB_REPO = "music-player-1";
    // 3. Change to the folder containing your music. 
    //    Leave as "" if your music is in the root directory.
    const MUSIC_FOLDER_PATH = "music";
    // --- END CONFIGURATION ---

    const audioPlayer = document.getElementById('audio-player');
    const playlistElement = document.getElementById('playlist');
    const nowPlayingElement = document.getElementById('now-playing');
    const loadingElement = document.getElementById('loading');
    
    let songs = [];
    let currentSongIndex = -1;

    // This function fetches the song list from the GitHub API
    async function fetchPlaylist() {
        const apiUrl = `https://api.github.com/repos/${GITHUB_USER}/${GITHUB_REPO}/contents/${MUSIC_FOLDER_PATH}`;
        
        try {
            const response = await fetch(apiUrl);
            if (!response.ok) {
                throw new Error(`GitHub API error: ${response.status}`);
            }
            const files = await response.json();
            
            // Filter for .mp3 files and create the songs array
            songs = files
                .filter(file => file.name.endsWith('.mp3'))
                .map(file => {
                    return {
                        // Cleans up the filename to make a nice title
                        title: file.name.replace('.mp3', '').replace(/_/g, ' '),
                        // Uses the relative path for the audio source
                        url: file.path 
                    };
                });

            if (songs.length > 0) {
                loadingElement.style.display = 'none';
                nowPlayingElement.textContent = 'Select a song to play';
                createPlaylistUI();
            } else {
                loadingElement.textContent = 'No MP3 files found in the specified folder.';
            }

        } catch (error) {
            console.error('Failed to fetch playlist:', error);
            loadingElement.textContent = 'Error: Could not load songs from GitHub.';
            nowPlayingElement.textContent = 'Error loading playlist.';
        }
    }

    function createPlaylistUI() {
        playlistElement.innerHTML = ''; // Clear the list
        songs.forEach((song, index) => {
            const listItem = document.createElement('li');
            listItem.textContent = song.title;
            listItem.dataset.index = index;
            playlistElement.appendChild(listItem);
        });
    }

    function playSong(index) {
        if (index < 0 || index >= songs.length) return;

        const song = songs[index];
        audioPlayer.src = song.url;
        audioPlayer.play();
        
        nowPlayingElement.textContent = `Now Playing: ${song.title}`;
        currentSongIndex = index;
        updateActivePlaylistItem();
    }
    
    function updateActivePlaylistItem() {
        const listItems = playlistElement.querySelectorAll('li');
        listItems.forEach((item, index) => {
            item.classList.toggle('active', index === currentSongIndex);
        });
    }

    playlistElement.addEventListener('click', (event) => {
        if (event.target && event.target.nodeName === 'LI') {
            const songIndex = parseInt(event.target.dataset.index, 10);
            playSong(songIndex);
        }
    });

    audioPlayer.addEventListener('ended', () => {
        playSong((currentSongIndex + 1) % songs.length);
    });

    // Start everything by fetching the playlist
    fetchPlaylist();
</script>

</body>
</html>
